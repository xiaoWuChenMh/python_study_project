
   
### 任务梳理

 当任务启动时，有两个主要的执行流程：1判断任务是否激活，2激活后的执行流程。

 通过循环嵌套的方式组织两个流程，即先判断是否激活，如果激活就执行后续流程。


### 判断任务是否激活


**任务梳理**

```text
-- 变量 --
重试次数=3（默认为3）
状态=0
-- 逻辑 --
重新点击跟随
从活动页领取任务：状态=0
需要重试3次
   
```


### 激活后的流程

```text

-- 变量 --
执行总轮数（向上取整） = 执行次数/5  (5次为一轮)
当前执行次数=0
当前执行轮数=0
卡图阈值=0
副本标识=0
is_sleep = True

-- 逻辑 --
 npc对话框: 点击、睡（反应）、卡图阈值+=1、副本标识=0、is_sleep = True
    if 状态==2： 状态=3
    if 状态==1： 状态=0
 npc的speak text: 点击、睡（反应）
    if 状态==3： 状态=1
 任务栏：点击、睡（反应）
 判断并点击继续标识：点击、睡（过图）、判断并点击继续标识（防止过图时没点到）、卡图阈值=0、当前执行轮数+1、状态=2
 副本标识：卡图阈值=0、副本标识+=1
    if 副本标识>0 and is_sleep:
       睡（副本最小执行时间秒-3）
       当前执行次数+=1
       is_sleep = False
       点击挂机
    else 
       点击任务栏
 判断卡图阈值：重新点击跟随、卡图阈值 = 0、睡（反应*3）


卡图：
   某个队员在其他线（取消并点击跟随能解决）
   全员不再正确的线，只能多次点击任务栏
   
副本标识：
   可能失败，因此当卡图阈值超过一定次数后，切换为匹配地图名
   
副本名：蒲家村角落、金銮殿、蛙鸣池
 
```


### 状态说明

```text
0-未激活：包括：npc对话框
1-激活任务：包括：全部
2-继续领取：包括：npc对话框、听了
3-领取中：包括：npc的speak text、副本内判断



状态（2,3），进入超时判断，修改状态
  超时，2-change-1 
  超时，3-change-1 
  

激活时有对话框，有npc文案？？？
```

   
